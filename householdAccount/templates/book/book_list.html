{% extends "book/base.html" %}
{% block content %}
{% if user.is_authenticated %}
<div class="content container">
    <form id="form" action="" method="GET">
        {{form.key_word}}
        <button type="submit" class="btn btn-primary btn-lg">検索</button>
    </form>

<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.2/Chart.bundle.js"></script>
<div class="chart-container">
    <canvas id="myChart-income"></canvas>
    <canvas id="myChart-outcome"></canvas>
</div>

<script type="text/javascript" src="{% url 'book:plot' %}"></script>

    <div class="table-responsive">
        <table class="table table-striped table-sm">
            <thead>
                <tr>
                    <th>#</th>
                    <th>日付</th>
                    <th>カテゴリ</th>
                    <th>金額</th>
                    <th>メモ</th>
                </tr>
            </thead>
            <tbody>
            <!--コンテキストが指定されていないので、views.pyで用いたモデル名を小文字にし、_listを付けたものがデフォルト-->
            {% for data in accountbook_list %}
                <tr data-href="{% url 'book:book_detail' pk=data.pk %}">
                    <td>{{data.id}}</td>
                    <td>{{data.date}}</td>
                    <td>{{data.category}}</td>
                    <td>{{data.money_amount}}</td>
                    <td>{{data.memo|linebreaksbr}}</td>
                </tr>
            {% endfor %}
            </tbody>
        </table>
    </div>
</div>
<script src="/static/js/clicktable.js"></script>
<a href="{% url 'book:import_csv' %}" class="btn btn-primary btn-lg space">CSV登録</a><br>
<a href="{% url 'book:book_add' %}" class="btn btn-primary btn-lg space">新規作成</a>
{% include 'book/page.html' %}
{% else %}
<h1>ようこそ「俺の家計簿！」へ。</h1>
<h3>あなたの家計簿を作ることができるアプリです。まずはユーザー登録してツールを使えるように準備しましょう。</h3>
{% endif %}
{% endblock %}
